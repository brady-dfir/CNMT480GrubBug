<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A08:2021</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="/"><img src="/static/images/logo_hori.png" alt="GrubBug Logo" width="200"></a>
            </div>
            <nav>
                <ul>
                    <li>Welcome, {{ user }} </li>
                    <li><form action="/logout"><button type="submit">Logout</button></form></li>
                    <li><form action="/mainpage"><button type="submit">Move to Homepage</button></form></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <br><br>
        <div class="container">
            <h1>A08-2021: Software and Data Integrity Failures</h1>
            <p>
                Software and Data Integrity Failures arise when critical systems lack mechanisms to ensure the integrity of their data or code. This can lead to exploitation through supply chain attacks, unauthorized updates, or vulnerable dependencies.
            </p>

            <div class="examples">
                <h2>Examples</h2>
                <ul>
                    <!-- <li><a href="/dependency-confusion">Dependency Confusion Attacks</a></li> -->
                    <!-- <li><a href="/unauthorized-updates">Unauthorized Software Updates</a></li> -->
                    <li><a href="/tampered-data">Tampered Data Integrity</a></li>
                    <!-- Add more examples as needed -->
                </ul>
            </div>

            <div class="challange">
                    
            </div>

            <div class="toggle-section">
                <h2>Secure/Insecure Mode</h2>
                <p>Use the button below to toggle the site between secure and insecure modes to observe the vulnerabilities.</p>
                <button id="toggle-mode" class="btn-primary">
                    Switch to Insecure Mode
                </button>
                <p id="mode-status">Current Mode: Secure</p>
            </div>
        </div>
    </main>

    <footer>
        <div class="flag-box" id="flagBox">
            <h2>Enter the Flag</h2>
            <input type="text" id="flagInput" />
            <button onclick="submitFlag()">Submit Flag</button>
        </div>
    </footer>

    <script>
        let isSecure = true;

        document.getElementById('toggle-mode').addEventListener('click', () => {
            isSecure = !isSecure;
            const mode = isSecure ? 'Secure' : 'Insecure';
            document.getElementById('mode-status').textContent = `Current Mode: ${mode}`;
        });

        // Dynamic solutions
        async function submitFlag() {
            const userFlag = document.getElementById("flagInput").value;
            const response = await fetch("/dynamicSolution", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    challenge_id: "A08_2021",
                    input: userFlag
                })
            });
            const result = await response.json();
            if (result.correct) {
                window.location.href = "/A08_2021_Flag";
            } else {
                alert(result.feedback + (result.explanation ? " " + result.explanation : ""));
            }
            return false;
        }
    </script>


</body>
</html>